import{o as l,c,d as e,r as u,p as Y,b as Z,q as U,x as f,g as w,t as i,e as g,l as E,j as W,u as C}from"./index-7980c7d1.js";import{g as Q,d as x,s as S,a as T,b as z}from"./index.esm2017-46c3146e.js";function G(y,p){return l(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M3.75 12a.75.75 0 01.75-.75h15a.75.75 0 010 1.5h-15a.75.75 0 01-.75-.75z","clip-rule":"evenodd"})])}function L(y,p){return l(),c("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[e("path",{"fill-rule":"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z","clip-rule":"evenodd"})])}const $={key:0,class:"text-white"},F={key:1,class:"flex gap-10 w-full text-white mt-10"},q={class:"flex-1"},H=["src"],P={class:"flex-1 flex flex-col justify-between"},X={class:"text-2xl"},K={class:"flex text-xs mt-4 justify-between"},ee={class:"bg-yellow-400 text-black min-w-[12px] px-1 rounded-md"},te={key:0},se={class:"italic"},ae={class:"mt-4"},oe=e("h2",{class:"text-xl mt-10"},"Overview",-1),ie={class:"mt-2 italic"},le={class:"flex justify-end"},re={__name:"MovieDetails",setup(y){const p=u("https://image.tmdb.org/t/p/w1280"),h=Y(),b=Z(),_=Q(),m=u(!1),t=u(null),j=u(null),v=u(!1),D={method:"GET",headers:{accept:"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI5ZDVjZWVjMzVjMDE3Zjk0NDQxNzQ4ZjNjY2YwNDEwZSIsInN1YiI6IjY1MTMwYzRkOGUyYmE2MDBjN2NkMWIxOSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.hk_-QMN0OB204_2OfksnyubxC8dR-3Svj0_wdqzwdYw"}};U(()=>{try{m.value=!0,B(),R(),O()}catch(s){console.error(s)}finally{m.value=!1}});const B=async()=>{const a=await(await fetch(`https://api.themoviedb.org/3/movie/${h.params.id}?language=en-US`,D)).json();t.value=a},R=async()=>{const a=await(await fetch(`https://api.themoviedb.org/3/movie/${h.params.id}/credits?language=en-US`,D)).json();j.value=a.cast.splice(0,5).map(o=>o.name).join(", ")},V=s=>s?Number(s).toFixed(1):"",J=async()=>{const s={id:t.value.id,title:t.value.title,poster_path:t.value.poster_path,release_date:t.value.release_date,vote_average:t.value.vote_average,overview:t.value.overview};f(w(),async a=>{if(a){const o=x(_,"users",a.uid);try{await S(o,{watchlist:T(s)},{merge:!0}),v.value=!0}catch(n){console.log(n)}}else b.push("/movie-app/login")})},A=()=>{f(w(),async s=>{if(s){const a=x(_,"users",s.uid);try{const r=(await z(a)).data().watchlist.filter(d=>d.id!==Number(h.params.id));await S(a,{watchlist:r},{merge:!0}),v.value=!1}catch(o){console.log(o)}}else b.push("/movie-app/login")})},O=()=>{f(w(),s=>{if(s){const a=x(_,"users",s.uid);z(a).then(o=>{if(o.exists()){const r=o.data().watchlist.some(d=>d.id===Number(h.params.id));v.value=r}})}})};return(s,a)=>{var o,n,r,d,N,k,M,I;return m.value?(l(),c("div",$,"...Loading")):(l(),c("div",F,[e("div",q,[e("img",{class:"w-full rounded-lg object-contain",src:p.value+((o=t.value)==null?void 0:o.backdrop_path),alt:"Movie Poster"},null,8,H)]),e("div",P,[e("h1",X,i((n=t.value)==null?void 0:n.title),1),e("div",K,[e("p",null,i((r=t.value)==null?void 0:r.runtime)+" min | "+i((d=t.value)==null?void 0:d.release_date),1),e("p",null,[g(" IMDb: "),e("span",ee,i(V((N=t.value)==null?void 0:N.vote_average)),1)])]),(k=t.value)!=null&&k.tagline?(l(),c("div",te,[e("span",se,i((M=t.value)==null?void 0:M.tagline),1)])):E("",!0),e("div",ae,"Starring: "+i(j.value),1),e("div",null,[oe,e("p",ie,i((I=t.value)==null?void 0:I.overview),1)]),e("div",le,[v.value?(l(),c("button",{key:1,onClick:A,type:"button",class:"button bg-red-500 mt-4 flex"},[W(C(G),{class:"h-5 w-5"}),g(" Remove ")])):(l(),c("button",{key:0,onClick:J,class:"button mt-4 flex",type:"button"},[W(C(L),{class:"h-5 w-5"}),g(" Watchlist ")]))])])]))}}};export{re as default};
